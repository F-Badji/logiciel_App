<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<AnchorPane xmlns="http://javafx.com/javafx/17.0.2-ea" xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="com.logicielapp.controller.PasswordRecoveryController">
   <children>
      <VBox alignment="CENTER" prefHeight="600.0" prefWidth="500.0" spacing="10.0" 
            styleClass="password-recovery-container">
         <padding>
            <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
         </padding>
         
         <!-- Header -->
         <VBox alignment="CENTER" spacing="10.0" styleClass="header-section">
            <Label fx:id="titleLabel" text="🔐 Récupération de Mot de Passe" 
                   styleClass="recovery-title" />
            <Label fx:id="subtitleLabel" text="Récupérez vos mots de passe oubliés en toute sécurité"
                   styleClass="recovery-subtitle" />
         </VBox>
         
         <!-- Progress Indicator -->
         <HBox alignment="CENTER" spacing="15.0" styleClass="progress-section">
            <Label fx:id="step1" text="1" styleClass="step-indicator, step-active" />
            <Label text="➤" styleClass="step-arrow" />
            <Label fx:id="step2" text="2" styleClass="step-indicator" />
            <Label text="➤" styleClass="step-arrow" />
            <Label fx:id="step3" text="3" styleClass="step-indicator" />
            <Label text="➤" styleClass="step-arrow" />
            <Label fx:id="step4" text="4" styleClass="step-indicator" />
         </HBox>
         
         <!-- Main Content Area -->
         <VBox fx:id="contentArea" alignment="CENTER" spacing="15.0" styleClass="content-area">
            
            <!-- Step 1: Initial Form -->
            <VBox fx:id="initialForm" spacing="15.0" styleClass="form-section">
               <Label text="Informations Requises" styleClass="section-title" />
               
               <VBox spacing="8.0">
                  <Label text="IMEI du téléphone (15 chiffres) :" styleClass="field-label" />
                  <TextField fx:id="imeiField" promptText="Exemple: 352807060008769" 
                            styleClass="input-field" />
                  <Label fx:id="imeiValidationLabel" styleClass="validation-message" />
               </VBox>
               
               <VBox spacing="8.0">
                  <Label text="Adresse email de récupération :" styleClass="field-label" />
                  <TextField fx:id="emailField" promptText="votre.email@exemple.com" 
                            styleClass="input-field" />
               </VBox>
               
               <VBox spacing="8.0">
                  <Label text="Type de mot de passe à récupérer :" styleClass="field-label" />
                  <ComboBox fx:id="passwordTypeComboBox" prefWidth="300.0" 
                           styleClass="combo-input" />
               </VBox>
               
               <Label fx:id="deviceInfoLabel" text="" styleClass="device-info" wrapText="true" />
            </VBox>
            
            <!-- Step 2: Email Verification -->
            <VBox fx:id="emailVerificationForm" spacing="15.0" styleClass="form-section" visible="false">
               <Label text="Vérification Email" styleClass="section-title" />
               <Label fx:id="emailSentLabel" text="" styleClass="info-message" wrapText="true" />
               
               <VBox spacing="8.0">
                  <Label text="Code de vérification (8 caractères) :" styleClass="field-label" />
                  <TextField fx:id="verificationCodeField" promptText="AB12CD34" 
                            styleClass="input-field" maxWidth="200.0" />
               </VBox>
               
               <HBox alignment="CENTER" spacing="10.0">
                  <Button fx:id="resendCodeButton" text="🔄 Renvoyer le code" 
                         styleClass="secondary-button" />
               </HBox>
            </VBox>
            
            <!-- Step 3: Security Questions -->
            <VBox fx:id="securityQuestionsForm" spacing="15.0" styleClass="form-section" visible="false">
               <Label text="Questions de Sécurité" styleClass="section-title" />
               <Label text="Répondez aux questions suivantes pour vérifier votre identité :" 
                      styleClass="info-message" />
               
               <VBox fx:id="questionsContainer" spacing="12.0">
                  <!-- Questions générées dynamiquement -->
               </VBox>
            </VBox>
            
            <!-- Step 4: Password Result -->
            <VBox fx:id="passwordResultForm" spacing="15.0" styleClass="form-section" visible="false">
               <Label text="✅ Récupération Réussie !" styleClass="section-title success" />
               
               <VBox spacing="12.0" styleClass="result-container">
                  <Label text="Nouveau mot de passe généré :" styleClass="field-label" />
                  <HBox alignment="CENTER_LEFT" spacing="10.0">
                     <TextField fx:id="newPasswordField" editable="false" 
                               styleClass="password-result" />
                     <Button fx:id="copyPasswordButton" text="📋 Copier" 
                            styleClass="copy-button" />
                     <Button fx:id="togglePasswordButton" text="👁️ Afficher" 
                            styleClass="toggle-button" />
                  </HBox>
                  
                  <Label text="Type de mot de passe :" styleClass="field-label" />
                  <Label fx:id="passwordTypeLabel" styleClass="info-value" />
                  
                  <Label text="Appareil détecté :" styleClass="field-label" />
                  <Label fx:id="deviceDetectedLabel" styleClass="info-value" />
                  
                  <Label text="Instructions de configuration :" styleClass="field-label" />
                  <ScrollPane prefHeight="120.0" fitToWidth="true" styleClass="instructions-scroll">
                     <TextArea fx:id="instructionsArea" editable="false" wrapText="true" 
                              styleClass="instructions-text" />
                  </ScrollPane>
                  
                  <Label text="⚠️ Important : Changez ce mot de passe dès que possible après récupération." 
                         styleClass="warning-message" wrapText="true" />
               </VBox>
            </VBox>
         </VBox>
         
         <!-- Status Messages -->
         <VBox alignment="CENTER" spacing="5.0" styleClass="status-section">
            <Label fx:id="statusLabel" styleClass="status-message" wrapText="true" />
            <ProgressBar fx:id="progressBar" prefWidth="300.0" visible="false" styleClass="progress-bar" />
         </VBox>
         
         <!-- Action Buttons -->
         <HBox alignment="CENTER" spacing="15.0" styleClass="button-section">
            <Button fx:id="cancelButton" text="❌ Annuler" styleClass="cancel-button" 
                   onAction="#handleCancel" />
            <Button fx:id="backButton" text="⬅️ Précédent" styleClass="secondary-button" 
                   onAction="#handleBack" visible="false" />
            <Button fx:id="nextButton" text="Démarrer ➤" styleClass="primary-button" 
                   onAction="#handleNext" />
         </HBox>
         
         <!-- Footer Info -->
         <VBox alignment="CENTER" spacing="5.0" styleClass="footer-section">
            <Label text="🔒 Toutes vos données sont sécurisées et chiffrées" 
                   styleClass="security-info" />
            <Label fx:id="sessionInfoLabel" text="" styleClass="session-info" />
         </VBox>
      </VBox>
   </children>
</AnchorPane>
