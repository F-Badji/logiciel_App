<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<BorderPane xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="com.logicielapp.controller.FaceIDRepairController" styleClass="dark-background">

    <!-- En-tÃªte -->
    <top>
        <VBox styleClass="header-section">
            <HBox alignment="CENTER" styleClass="title-bar">
                <Label styleClass="window-title" text="ðŸ”’ RÃ©paration Face ID - Diagnostic et Calibration">
                    <font>
                        <Font name="System Bold" size="18.0" />
                    </font>
                </Label>
            </HBox>
            
            <HBox alignment="CENTER" spacing="20.0" styleClass="info-bar">
                <Label text="Diagnostic et RÃ©paration Face ID - Compatible iPhone X Ã  iPhone 15 Pro Max" 
                       styleClass="info-text" />
            </HBox>
        </VBox>
    </top>

    <!-- Contenu principal -->
    <center>
        <ScrollPane fitToWidth="true" hbarPolicy="NEVER" vbarPolicy="AS_NEEDED">
            <content>
                <VBox spacing="20.0" styleClass="main-content">
                    <padding>
                        <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                    </padding>

                    <!-- Section dÃ©tection d'appareil -->
                    <VBox spacing="10.0" styleClass="section-box-dark">
                        <Label text="ðŸ“± DÃ©tection et Analyse d'Appareil" styleClass="section-title-dark">
                            <font>
                                <Font name="System Bold" size="14.0" />
                            </font>
                        </Label>
                        
                        <HBox spacing="8.0" alignment="CENTER_LEFT">
                            <Button fx:id="detectBtn" text="ðŸ” DÃ©tecter iPhone" 
                                    onAction="#handleDetectDevices" styleClass="action-button-dark" />
                            <Button fx:id="refreshBtn" text="ðŸ”„ Actualiser" 
                                    onAction="#handleRefreshDevices" styleClass="action-button-dark" />
                            <Button fx:id="diagnoseFaceIDBtn" text="ðŸ”¬ Diagnostic Face ID" 
                                    onAction="#handleDiagnoseFaceID" styleClass="action-button-dark" />
                        </HBox>
                        
                        <VBox spacing="10.0">
                            <Label text="Appareil dÃ©tectÃ©:" styleClass="field-label-dark" />
                            <ComboBox fx:id="deviceComboBox" promptText="Aucun appareil dÃ©tectÃ©" 
                                      prefWidth="400.0" styleClass="device-combo-dark" />
                        </VBox>
                        
                        <GridPane hgap="15.0" vgap="10.0">
                            <columnConstraints>
                                <ColumnConstraints minWidth="120.0" />
                                <ColumnConstraints minWidth="200.0" />
                                <ColumnConstraints minWidth="120.0" />
                                <ColumnConstraints minWidth="200.0" />
                            </columnConstraints>
                            
                            <Label text="ModÃ¨le:" styleClass="info-label-dark" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                            <Label fx:id="modelLabel" text="Non dÃ©tectÃ©" styleClass="info-value-dark" GridPane.columnIndex="1" GridPane.rowIndex="0" />
                            
                            <Label text="Face ID:" styleClass="info-label-dark" GridPane.columnIndex="2" GridPane.rowIndex="0" />
                            <Label fx:id="faceIDStatusLabel" text="Non testÃ©" styleClass="info-value-dark" GridPane.columnIndex="3" GridPane.rowIndex="0" />
                            
                            <Label text="Version iOS:" styleClass="info-label-dark" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                            <Label fx:id="iosVersionLabel" text="Inconnue" styleClass="info-value-dark" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                            
                            <Label text="Capteur TrueDepth:" styleClass="info-label-dark" GridPane.columnIndex="2" GridPane.rowIndex="1" />
                            <Label fx:id="trueDepthStatusLabel" text="En cours..." styleClass="info-value-dark" GridPane.columnIndex="3" GridPane.rowIndex="1" />
                            
                            <Label text="NumÃ©ro de sÃ©rie:" styleClass="info-label-dark" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                            <Label fx:id="serialLabel" text="Non disponible" styleClass="info-value-dark" GridPane.columnIndex="1" GridPane.rowIndex="2" />
                            
                            <Label text="CompatibilitÃ©:" styleClass="info-label-dark" GridPane.columnIndex="2" GridPane.rowIndex="2" />
                            <Label fx:id="compatibilityLabel" text="VÃ©rification..." styleClass="info-value-dark" GridPane.columnIndex="3" GridPane.rowIndex="2" />
                        </GridPane>
                    </VBox>

                    <!-- Section diagnostic Face ID -->
                    <VBox spacing="10.0" styleClass="section-box-dark">
                        <Label text="ðŸ” Diagnostic Face ID AvancÃ©" styleClass="section-title-dark">
                            <font>
                                <Font name="System Bold" size="14.0" />
                            </font>
                        </Label>
                        
                        <GridPane hgap="20.0" vgap="15.0">
                            <columnConstraints>
                                <ColumnConstraints minWidth="200.0" />
                                <ColumnConstraints minWidth="150.0" />
                                <ColumnConstraints minWidth="200.0" />
                                <ColumnConstraints minWidth="150.0" />
                            </columnConstraints>
                            
                            <Label text="ðŸ“· CamÃ©ra TrueDepth:" styleClass="diagnostic-label-dark" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                            <Label fx:id="cameraStatusLabel" text="Non testÃ©" styleClass="status-pending-dark" GridPane.columnIndex="1" GridPane.rowIndex="0" />
                            
                            <Label text="ðŸ’¡ Projecteur infrarouge:" styleClass="diagnostic-label-dark" GridPane.columnIndex="2" GridPane.rowIndex="0" />
                            <Label fx:id="projectorStatusLabel" text="Non testÃ©" styleClass="status-pending-dark" GridPane.columnIndex="3" GridPane.rowIndex="0" />
                            
                            <Label text="ðŸ“¡ Capteur de proximitÃ©:" styleClass="diagnostic-label-dark" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                            <Label fx:id="proximityStatusLabel" text="Non testÃ©" styleClass="status-pending-dark" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                            
                            <Label text="ðŸŒŸ Illuminateur infrarouge:" styleClass="diagnostic-label-dark" GridPane.columnIndex="2" GridPane.rowIndex="1" />
                            <Label fx:id="illuminatorStatusLabel" text="Non testÃ©" styleClass="status-pending-dark" GridPane.columnIndex="3" GridPane.rowIndex="1" />
                            
                            <Label text="ðŸ§  Processeur Neural Engine:" styleClass="diagnostic-label-dark" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                            <Label fx:id="neuralEngineStatusLabel" text="Non testÃ©" styleClass="status-pending-dark" GridPane.columnIndex="1" GridPane.rowIndex="2" />
                            
                            <Label text="ðŸ” Secure Enclave:" styleClass="diagnostic-label-dark" GridPane.columnIndex="2" GridPane.rowIndex="2" />
                            <Label fx:id="secureEnclaveStatusLabel" text="Non testÃ©" styleClass="status-pending-dark" GridPane.columnIndex="3" GridPane.rowIndex="2" />
                        </GridPane>
                        
                        <HBox spacing="8.0" alignment="CENTER_LEFT">
                            <Button fx:id="runFullDiagnosticBtn" text="ðŸ”¬ Diagnostic Complet" 
                                    onAction="#handleRunFullDiagnostic" styleClass="action-button-dark" />
                            <Button fx:id="testFaceIDBtn" text="ðŸ‘¤ Test Face ID" 
                                    onAction="#handleTestFaceID" styleClass="action-button-dark" />
                            <Button fx:id="calibrateSensorsBtn" text="âš™ï¸ Calibrer Capteurs" 
                                    onAction="#handleCalibrateSensors" styleClass="action-button-dark" />
                        </HBox>
                    </VBox>

                    <!-- Section outils de rÃ©paration -->
                    <VBox spacing="10.0" styleClass="section-box-dark">
                        <Label text="ðŸ”§ Outils de RÃ©paration Face ID" styleClass="section-title-dark">
                            <font>
                                <Font name="System Bold" size="14.0" />
                            </font>
                        </Label>
                        
                        <VBox spacing="6.0">
                            <RadioButton fx:id="softwareRepairRadio" text="ðŸ’» RÃ©paration Logicielle (RecommandÃ©)" 
                                         selected="true" styleClass="radio-button-dark">
                                <toggleGroup>
                                    <ToggleGroup fx:id="repairMethodGroup" />
                                </toggleGroup>
                            </RadioButton>
                            
                            <RadioButton fx:id="firmwareRepairRadio" text="ðŸ”„ RÃ©paration Firmware" 
                                         toggleGroup="$repairMethodGroup" styleClass="radio-button-dark" />
                            
                            <RadioButton fx:id="hardwareCalibrationRadio" text="âš™ï¸ Calibration MatÃ©rielle" 
                                         toggleGroup="$repairMethodGroup" styleClass="radio-button-dark" />
                            
                            <RadioButton fx:id="factoryResetRadio" text="ðŸ­ RÃ©initialisation Usine Face ID" 
                                         toggleGroup="$repairMethodGroup" styleClass="radio-button-dark" />
                        </VBox>
                        
                        <VBox spacing="6.0">
                            <Label text="â„¹ï¸ La rÃ©paration logicielle corrige la plupart des problÃ¨mes Face ID sans risque" 
                                   styleClass="info-text-dark" wrapText="true" />
                            <CheckBox fx:id="backupFaceIDCheckBox" text="Sauvegarder les donnÃ©es Face ID avant rÃ©paration" 
                                      selected="true" styleClass="checkbox-dark" />
                            <CheckBox fx:id="testAfterRepairCheckBox" text="Tester Face ID aprÃ¨s rÃ©paration" 
                                      selected="true" styleClass="checkbox-dark" />
                            <CheckBox fx:id="recalibrateCheckBox" text="Recalibrer automatiquement les capteurs" 
                                      selected="false" styleClass="checkbox-dark" />
                        </VBox>
                    </VBox>

                    <!-- Section progression -->
                    <VBox spacing="10.0" styleClass="section-box-dark">
                        <Label text="ðŸ“Š Progression de la RÃ©paration" styleClass="section-title-dark">
                            <font>
                                <Font name="System Bold" size="14.0" />
                            </font>
                        </Label>
                        
                        <VBox spacing="6.0">
                            <HBox spacing="10.0" alignment="CENTER_LEFT">
                                <Label text="Statut:" styleClass="field-label-dark" />
                                <Label fx:id="statusLabel" text="PrÃªt" styleClass="status-ready-dark" />
                            </HBox>
                            
                            <ProgressBar fx:id="progressBar" prefWidth="500.0" progress="0" 
                                         styleClass="repair-progress-dark" />
                            
                            <Label fx:id="progressLabel" text="En attente..." styleClass="progress-text-dark" />
                        </VBox>
                    </VBox>

                    <!-- Section logs -->
                    <VBox spacing="10.0" styleClass="section-box-dark">
                        <HBox spacing="10.0" alignment="CENTER_LEFT">
                            <Label text="ðŸ“ Journal de RÃ©paration" styleClass="section-title-dark">
                                <font>
                                    <Font name="System Bold" size="14.0" />
                                </font>
                            </Label>
                            <Button fx:id="clearLogsBtn" text="ðŸ—‘ï¸ Effacer" onAction="#handleClearLogs" 
                                    styleClass="action-button-dark" />
                        </HBox>
                        
                        <TextArea fx:id="logArea" prefHeight="80.0" editable="false" 
                                  wrapText="true" styleClass="text-area-dark" 
                                  promptText="Les dÃ©tails du processus de rÃ©paration s'afficheront ici..." />
                    </VBox>
                </VBox>
            </content>
        </ScrollPane>
    </center>

    <!-- Boutons d'action et footer -->
    <bottom>
        <VBox styleClass="footer-section">
            <!-- Boutons d'action -->
            <HBox spacing="15.0" alignment="CENTER" styleClass="button-bar">
                <padding>
                    <Insets bottom="15.0" left="20.0" right="20.0" top="15.0" />
                </padding>
                
                <Button fx:id="startRepairBtn" text="ðŸš€ DÃ©marrer la RÃ©paration" 
                        onAction="#handleStartRepair" styleClass="start-button" 
                        disable="true" prefWidth="200.0" />
                
                <Button fx:id="stopBtn" text="â¹ï¸ ArrÃªter" onAction="#handleStopRepair" 
                        styleClass="stop-button" disable="true" prefWidth="120.0" />
                
                <Button fx:id="helpBtn" text="â“ Aide" onAction="#handleHelp" 
                        styleClass="help-button" prefWidth="100.0" />
                
                <Button fx:id="closeBtn" text="âŒ Fermer" onAction="#handleClose" 
                        styleClass="close-button" prefWidth="100.0" />
            </HBox>
            
            <!-- Footer professionnel -->
            <VBox alignment="CENTER" spacing="5.0" styleClass="copyright-footer">
                <Label text="Logiciel developpe par : F.Badji" styleClass="footer-text" />
                <Label text="Logiciel de DÃ©blocage Mobile - Â© 2025" styleClass="footer-text" />
                <padding>
                    <Insets bottom="8.0" left="15.0" right="15.0" top="8.0" />
                </padding>
            </VBox>
        </VBox>
    </bottom>

</BorderPane>
